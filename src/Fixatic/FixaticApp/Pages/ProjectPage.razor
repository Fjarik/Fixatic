@page "/project/{RouteProjectId:int}/{RouteSelectedTicketId:int?}"
@layout AppLayout
@using Fixatic.Types

<MudGrid>
    <MudItem xs="12">
        @if (Project != null)
        {
            <MudText Typo="Typo.h5" Class="pa-4 object-fill">Project: @Project.Name</MudText>
        }
        else
        {
            <MudText Typo="Typo.body1">Loading project tickets</MudText>
        }
    </MudItem>
    <MudItem xs="2">
        @if (Project != null)
        {
            <MudTable T="FullTicket" Hover="true" Striped="true"
                  Items="@_tickets" OnRowClick="@OnTicketSelect">
                <HeaderContent>
                    <MudTh>Tickets</MudTh>
                </HeaderContent>
                <RowTemplate>
                    <MudTd DataLabel="Nr">@context.Title</MudTd>
                </RowTemplate>
                <PagerContent>
                    <MudTablePager HorizontalAlignment="HorizontalAlignment.Left" HidePageNumber="true" HideRowsPerPage="true" />
                </PagerContent>
            </MudTable>
        }
    </MudItem>
    <MudItem xs="10">
        @if (_selectedTicket != null)
        {
            <MudToolBar Class="pl-0">
                <MudIconButton Icon="@Icons.Material.Outlined.Add" OnClick="OnAddTicket" />
                <MudIconButton Icon="@Icons.Material.Outlined.Edit" OnClick="OnEditClick" />
                <MudIconButton Icon="@Icons.Material.Outlined.Comment" OnClick="OnCommentTicketAsync" />

                <MudIconButton Icon="@Icons.Material.Outlined.DeleteForever" OnClick="OnRemoveTicketAsync" />

                @if (_isFollowed)
                {
                    <MudIconButton Title="Followed" Icon="@Icons.Filled.Star" OnClick="OnFollowTicketClick" />
                }
                else
                {
                    <MudIconButton Title="Follow" Icon="@Icons.Filled.StarBorder" OnClick="OnFollowTicketClick" />
                }
            </MudToolBar>

            <MudDivider />

            <TicketView Model="_selectedTicket" />
        }
    </MudItem>
</MudGrid>